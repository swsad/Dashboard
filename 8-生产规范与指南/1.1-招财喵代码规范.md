# 招财喵代码规范

## 前端代码规范

### JS规范

#### 1、命名规范

变量名以及函数名统一采用驼峰命名法，正常情况下函数名需要加上清晰的动词表示函数功能。常量名的所有字母大写，通过下划线连接常量名中的各单词。

#### 2、声明规范

使用`var`声明变量，使用`const`声明常量。

#### 3、注释规范

对数据变量进行说明的注释采用`/**/`，对代码进行说明的注释采用`//`。对数据变量的注释置于整个代码块的上一行或下一行，对代码的注释置于代码行末，代码与`//`之间保持2个空格，`//`与注释之间保持1个空格。

#### 4、数据绑定规范

所有涉及到数据绑定的变量均需在data中初始化，所有在data中初始化的变量需要使用setData进行更新。

```javascript
// 初始化
Page({
  data: {
    id : null
  }
})

// 更新
this.setData({
  id: ID
})
```

#### 5、函数定义规范

对于WXML中组件绑定的函数，需要在名称中标明组件名和绑定方法。对于各个页面常用的函数，需要在全局工具文件`utils.js`中定义。

```javascript
// 引入全局常用函数
var util = require('../../utils.js')
```



### WXML规范

- 控制每行代码数量在50个字符以内，方便阅读浏览，多余的代码进行换行处理，标签所带属性不进行换行。
- 每一个组件都需要指定class，即使不在.wxss文件中定义。



### WXSS规范

+ 在开发过程中统一使用rpx尺寸单位。

  > rpx（responsive pixel）: 可以根据屏幕宽度进行自适应。规定屏幕宽为750rpx。如在 iPhone6 上，屏幕宽度为375px，共有750个物理像素，则750rpx = 375px = 750物理像素，1rpx = 0.5px = 1物理像素。

+ 同一属性放置在一起，避免散乱。

  ```css
  .class {
    margin-left: 10rpx;
    margin-right: 10rpx
  }
  ```

+ 每个样式类之前空一行。

+ 采用`flex`进行布局。

+ 在样式类外部添加块状注释。



## 云后台规范

### 云接口实现规范

#### 1. 函数注释

在云接口开头的地方，写上云接口的功能，接受的参数及其类型，返回的对象及其代表的意义。例如：

```javascript
/*
 功能：添加用户基本信息
 接受参数：
 user_type: num 表示用户类型
 user_info: object  用户或组织的所有信息
 返回情况：
 {
   success: bool
   error: object  系统内部错误
 }
*/
```

#### 2. 返回值

云接口返回的对象有：

1. `success：bool`表达这次调用云接口是否成功；
2. `error：object`表示云函数调用发生的错误（如有），可能是库调用的错误，也可能是逻辑上主动`throw`的错误；
3. 还有一些该接口特有的其他前端需要知道的返回值。

#### 3. 异常处理

云接口统一采用`try throw catch`的方式来处理异常，抛出的异常放入返回对象的error字段中。

```javascript
try{
	// 接口实现
} catch(err) {
    return {
      success: false,
      error: err
    }
}
```

#### 3. 日志

云接口执行过程中，实时将运行情况输出到日志中，分为三种log信息：

1. `[参数]: xxx` 记录进入云接口时输入的参数
2. `[完成]: xxx`记录云接口返回时完成的操作，云接口可能有多处返回点，这样方便得知从哪个返回点退出。
3. `[错误]: xxx` 记录云函数出错的信息。

### JS规范

#### 1. 变量声明规范

声明可变变量名必须加上`var`关键字，声明常量变量名必须加上`const`关键字。

> 当你没有写 var, 变量就会暴露在全局上下文中, 这样很可能会和现有变量冲突. 另外, 如果没有加上, 很难明确该变量的作用域是什么。 

云接口命名：采用`verb_noun`的形式，`send_verification`，代表发送验证邮箱。

常量命名：采用全大写的形式，如`UPPERBOUNDERCODE`。

#### 2. 注释

多行注释使用`/**/`, 注释使用空格缩进，如：

```javascript
/*
 功能：xxx
*/
```

单行注释使用`//`

- 注释文字与`//`保留一个空格。
- 在代码之后添加注释，`//`与代码之间保留一个空格